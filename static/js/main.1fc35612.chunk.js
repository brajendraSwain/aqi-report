(this["webpackJsonpaqi-report"]=this["webpackJsonpaqi-report"]||[]).push([[0],{61:function(e,t,n){},62:function(e,t,n){},67:function(e,t,n){},69:function(e,t,n){},89:function(e,t,n){},90:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n(19),i=n.n(c),r=(n(61),n(62),n(3)),o=n(20),s=n(21),l=n(26),u=n(25),j=n(7),d=function(e){return{type:"ADD_TO_HISTORY",payload:e}},b=n(54),O=n(50),h=n.n(O),f=(n(67),[{class:"good",range:[0,50]},{class:"satisfactory",range:[51,100]},{class:"moderate",range:[101,200]},{class:"poor",range:[201,300]},{class:"very_poor",range:[301,400]},{class:"severe",range:[401,500]}]),p="positive",v="negative",y=f.map((function(e){return e.class}));var m=n(2),x={};function g(e){var t=e.rowData,n=e.onRowClick,a=t.city,c=t.aqi,i=t.lastUpdated,r=function(e){var t;return null===(t=f.find((function(t){return e>=t.range[0]&&e<=t.range[1]})))||void 0===t?void 0:t.class}(Math.round(c)),o=function(e,t,n){return n||-1!==y.indexOf(n)?y.indexOf(t)<y.indexOf(n)?p:y.indexOf(t)>y.indexOf(n)?v:"":""}(0,r,x[a]),s="aqi-cell ".concat(r),l="aqi-row bg-animate ".concat(o);return x[a]=r,Object(m.jsxs)("tr",{className:l,onClick:n,children:[Object(m.jsx)("td",{className:"aqi-cell",children:a}),Object(m.jsx)("td",{className:s,children:c}),Object(m.jsx)("td",{className:"aqi-cell",children:h()(i).fromNow()})]})}function C(){return Object(m.jsxs)("tr",{className:"aqi-head-row",children:[Object(m.jsx)("td",{className:"aqi-cell",children:"City"}),Object(m.jsx)("td",{className:"aqi-cell",children:"Current AQI"}),Object(m.jsx)("td",{className:"aqi-cell",children:"Last Updated"})]})}var D=Object(j.b)((function(e){return{aqiCityData:e.aqi.allCityData}}))((function(e){var t=e.aqiCityData,n=e.dispatch;function a(e,t){t.ctrlKey?n({type:"ADD_REMOVE_CITY_FOR_COMPARE",payload:e.city}):n(function(e){return{type:"SELECT_SINGLE_CITY",payload:e}}(e.city))}return Object(m.jsx)("table",{className:"aqi-table",children:Object(m.jsxs)("tbody",{children:[Object(m.jsx)(C,{}),Object.entries(t).map((function(e){var t=Object(b.a)(e,2),n=t[0],c=t[1];return Object(m.jsx)(g,{rowData:c,onRowClick:a.bind(null,c)},n)}))]})})})),q=(n(69),n(70),n(6));n(89);var w=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={hovered:null},a}return Object(s.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.history,a=t.cities;if(!a.length)return Object(m.jsx)("div",{className:"line-container",children:Object(m.jsxs)("div",{className:"no-data",children:["No Cities are Selected ",Object(m.jsx)("br",{})," Click on the row to see city in live chart"]})});var c=window.innerWidth-650;c=c<500?500:c;var i=function(e,t){var n=Math.min(21,t.length),a=t.length>n?t.slice(t.length-21,t.length):t,c={};e.forEach((function(e){c[e]=[]}));for(var i=function(t){e.forEach((function(e){var i=a[t][e],r={x:"".concat(3*(n-t-1)," sec ago"),y:(null===i||void 0===i?void 0:i.aqi)||null};c[e].push(r)}))},r=0;r<n;r++)i(r);return e.map((function(e){return c[e]}))}(a,n),o=this.state.hovered;return Object(m.jsx)("div",{className:"line-container",children:Object(m.jsxs)(q.g,{xType:"ordinal",height:500,width:c,margin:{bottom:70},children:[Object(m.jsx)(q.e,{}),Object(m.jsx)(q.c,{}),Object(m.jsx)(q.f,{tickLabelAngle:-45}),Object(m.jsx)(q.h,{}),i.map((function(t,n){return Object(m.jsx)(q.d,{style:{strokeWidth:"3px"},data:t,getNull:function(e){return null!==e.y},onValueMouseOver:function(t){return e.setState({hovered:Object(r.a)(Object(r.a)({},t),{},{series:a[n]})})},onValueMouseOut:function(t){return e.setState({hovered:!1})}},a[n])})),o&&Object(m.jsx)(q.b,{value:o}),Object(m.jsx)(q.a,{orientation:"horizontal",width:c,items:a})]})})}}]),n}(a.PureComponent),N=Object(j.b)((function(e){return{history:e.aqi.history,cities:e.aqi.citiesInCompare}}))(w),I=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=!0,n=this,a=new WebSocket("wss://city-ws.herokuapp.com");a.onopen=function(e){console.info("ws connection opened",e)},a.onmessage=function(e){if(n.onAQIDataChange(JSON.parse(e.data)),t){var a=n.props,c=a.dispatch,i=a.aqiCityData;c(d(i))}t=!1},a.onerror=function(e){console.error("ws connection error",e)},setInterval((function(){var t=e.props,n=t.dispatch,a=t.aqiCityData;n(d(a))}),3e3)}},{key:"onAQIDataChange",value:function(e){var t=new Date,n=this.props,a=n.dispatch,c=n.aqiCityData,i=Object.fromEntries(e.map((function(e){return[e.city,Object(r.a)(Object(r.a)({},e),{},{aqi:+e.aqi.toFixed(2),lastUpdated:t})]})));a({type:"ADD_DATA",payload:Object(r.a)(Object(r.a)({},c),i)})}},{key:"render",value:function(){return Object(m.jsxs)("div",{className:"home-page-container",children:[Object(m.jsx)("div",{className:"heading",children:" Air Quality Monitoring "}),Object(m.jsxs)("div",{className:"body-container",children:[Object(m.jsx)(D,{}),Object(m.jsx)(N,{})]})]})}}]),n}(a.PureComponent),_=Object(j.b)((function(e){return{aqiCityData:e.aqi.allCityData}}))(I);var A=function(){return Object(m.jsx)(_,{})},E=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,92)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),a(e),c(e),i(e),r(e)}))},T=n(13),k=n(52),S=n(37),R={allCityData:{},history:[],citiesInCompare:[]};function M(e,t){var n=[].concat(Object(S.a)(e),[t]);return n.length<=60?n:Object(k.a)(n).slice(1)}var L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_DATA":return Object(r.a)(Object(r.a)({},e),{},{allCityData:t.payload});case"ADD_TO_HISTORY":var n=M(e.history,t.payload);return Object(r.a)(Object(r.a)({},e),{},{history:n});case"ADD_REMOVE_CITY_FOR_COMPARE":var a=e.citiesInCompare,c=t.payload;return a=a.includes(c)?a.filter((function(e){return e!==c})):[].concat(Object(S.a)(a),[c]),Object(r.a)(Object(r.a)({},e),{},{citiesInCompare:a});case"SELECT_SINGLE_CITY":return Object(r.a)(Object(r.a)({},e),{},{citiesInCompare:[t.payload]});default:return e}},F=Object(T.combineReducers)({aqi:L}),P=n(53),Y=Object(T.createStore)(F,Object(P.composeWithDevTools)());i.a.render(Object(m.jsx)(j.a,{store:Y,children:Object(m.jsx)(A,{})}),document.getElementById("root")),E()}},[[90,1,2]]]);
//# sourceMappingURL=main.1fc35612.chunk.js.map